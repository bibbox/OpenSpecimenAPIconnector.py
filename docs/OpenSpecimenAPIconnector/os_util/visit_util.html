<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>OpenSpecimenAPIconnector.os_util.visit_util API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>OpenSpecimenAPIconnector.os_util.visit_util</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#! /bin/python3

from ..os_core.visit import visit
from ..os_core.jsons import Json_factory
from ..os_core.url import url_gen
import json
import io
import pandas
import time

class visit_util:

    &#34;&#34;&#34;Handles the API calls for Visits

    This class handles the API calls for OpenSpecimen Visits. It can create, update, 
    search visits with different parameters, add visits and specimens in one call.
    The outputs are JSON dicts or the Error messages as dict. 

    Notes
    -----
    In order to use this and also the other classes, the user has to know OpenSpecimen.
    The API calls are documented in https://openspecimen.atlassian.net/wiki/spaces/CAT/pages/1116035/REST+APIs and 
    the calls refer to this site. More details can be seen in the documentation.

    Example
    -------
    A code example, where the visits are handled is in the Jupyter-Notebook::
        $ jupyter notebook main.ipynb
    &#34;&#34;&#34;

    def __init__(self):

        &#34;&#34;&#34;Constructor of the Class visit
        
        Constructor of the class visit, can handle the basic API-calls
        of the visits in OpenSpecimen. It also connects this class to the os_core classes
        visit, Json_factory, url_gen.
        
        Parameters
        ----------
        base_url : string
            URL to openspecimen, has the format: http(s)://&lt;host&gt;:&lt;port&gt;/openspecimen/rest/ng
        auth : tuple
            Consists of two strings ( loginname , password)
        &#34;&#34;&#34; 

        self.visit = visit()
        self.jsons = Json_factory()
        self.url = url_gen()


    def add_visit(self, name, site, eventid=None, eventlabel=None, cprid= None, ppid=None, cptitle=None, cpshorttitle=None,
                        cpid=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=&#34;Complete&#34;, missedreason=None,
                        missedby=None, comments=None,pathologynumber=None,cohort=None, visitdate=None):
        
        &#34;&#34;&#34;Add a visit to a Participant.

        Add a visit to a participant in OpenSpecimen via API call. To use this function, one has to know the
        Parameters of the Participant, event and site.

        Note
        ----
        Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
        - name, site     

        Parameters
        ----------
        name : string
            Name of the Visit.

        site : string
            Site to which the Visit belongs to.

        eventid : int
            ID of the event to which the visit belongs to.[optional]

        eventlabel : string
            Label of the event to which the visit belongs to.[optional]

        cprid : int
            Identifier of the Collection Protocoll Registration to which the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        ppid : string
            Identifier of the Participant to whom the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        cptitle : string
            Name of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        cpshorttitle : title
            Acronym of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        cpid : int
            Identifier of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        diagnosis : string
            Name of the diagnoses of the visit.

        clinicalstatus : string
            Clinical Status of the visit.[optional]

        activity : string
            Activity Status of the Visit.[optional]

        visitstatus : string
            Status of the visit.[optional]

        missedreason : string
            Reason why the visit was missed.[optional]

        missedby : string
            Details of the person who missed the visit.[optional]

        comments : string
            Comments regarding the visit.[optional]

        pathologynumber : string
            Surgical Pathology number. [optional]

        cohort : string
            Cohorts to which the visit belongs to. [optional]

        visitdate : string
            Date when the visit will occur, if empty takes the current date.[optional]

        Returns
        -------
        dict
            Details of the visit as JSON dict or the Openspecimen&#39;s error message.
        &#34;&#34;&#34;

        vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                        cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                        visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                        pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
        
        r = self.visit.add_visit(params = vis)

        return r


    def add_visit_speci(self,  name, lineage, av_qty, user, init_qty, spec_class, spec_type, anat_site, site, path,
                        speclabel = None, eventid=None, eventlabel=None, cprid = None, ppid=None, cptitle=None, cpshorttitle=None,
                        cpid = None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None,
                        missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, laterality=None, rec_qlt = None,                        
                        colltime = None, rectime = None, status=&#34;Collected&#34;, stor_name=None, storlocx =None, storlocy =None, concentration=None, 
                        biohazrad = None, collproc=None, conttype = None, extensionudn = None, extensionmap = None,
                        extensiondict = None):

        &#34;&#34;&#34;Add a visit and a specimen in one call.
        
        Add a visit and a specimen in OpenSpecimen via one API call. To use this function, one has to know the
        Parameters of the participant, event and site.

        Note
        ----
        Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
        - name, site
        The label is mandatory if the Protocolsettings are such that the Label is created manually, otherwise
        it has to be left empty.  

        Parameters
        ----------
        cprid : int
            Identifier of the Collection Protocoll Registration to which the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        name : string
            Name of the Visit.
        
        lineage : string
            Lineage of the specimen, if created it is New.
        
        av_qty : int
            The available quantity of a specimen.
        
        user : int
            ID of the user who creates the specimen. If not specified the API user is taken.
        
        init_qty : int
            The initial quantity of a specimen.

        spec_class : string
            Class of the specimen.
        
        spec_type : string
            Type of the specimen, belongs to the class.
        
        anat_site : string
            The anatomic site of the specimen.

        site : string
            Site to which the visit belongs to.
        site,
        eventid : int
            ID of the event to which the visit belongs to.[optional]
        
        eventlabel : string
            Label of the event to which the visit belongs to.[optional]
        
        ppid : string
            Identifier of the Participant to whom the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cptitle : string
            Name of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpshorttitle : title
            Acronym of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpid : int
            Identifier of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        diagnosis : string
            Name of the diagnoses of the visit.
        
        clinicalstatus : string
            Clinical Status of the visit.[optional]
        
        activity : stringsite,
            Activity Status of the visit.[optional]

        visitstatus : string
            Status of the visit.[optional]

        missedreason : string
            Reason why the visit was missed.[optional]

        missedby : string
            Details of the person who missed the visit.[optional]

        comments : string
            Comments regarding the visit.[optional]
        
        pathologynumber : string
            Surgical Pathology number. [optional]
        
        cohort : string
            Cohorts to which the visit belongs to. [optional]

        visitdate : string
            Date when the visit will occur, if empty takes the current date.[optional]
        
        pathology : string
            Pathologystatus of the Specimen.
        
        laterality : string
            The laterality of the specimen.
               
        recqlt : string
            The received quality.
   
        colltime : string
            Date and Time of the collection event, the format is in the OpenSpecimen&#39;s System configuration.[optional]
            
        rectime : string
            Date and Time of the received event, the format is in the OpenSpecimen&#39;s System configuration.[optional]
                        
        status : string
            Status of the Specimen, default is &#39;Collected&#39;.
        
        stor_name : string
            Name of the container. [optional]
        
        storlocx : int
            Position of the specimen in the Container in x direction.[optional]

        storlocy : int
            Position of the specimen in the container in y direction.[optional]
            
        concetration  : int
            Concentration of the specimen[optional].
        
        biohazard : string
            Biohazards of that specimen.[optional]
                    
        comments : string
            Comments regarding to the specimen[optional].
        
        collproc : string
            The procedure of the collection[otpional].

        conttype : string
            Type of the storage container.
            
        extensionudn : string
            OpenSpecimen&#39;s boolean true/false. If true, the extension keys are the udn values of the corresponding form.[optional]
        
        extensionmap : string
            The name of the form which should be taken.[optional]

        extensiondict : dict
            The dictionary of the extensions, has to be created manually. Either with udn or name (as defined before). [optional]

        Returns
        -------
        dict
            Details of the visit and specimen as JSON dict or the Openspecimen&#39;s error message.
        &#34;&#34;&#34;

        vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                        cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                        visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                        pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
        
        if stor_name!=None:
            storloc = self.jsons.storage_location_json(name= stor_name, xpos=storlocx, ypos= storlocy)
        else:
            storloc=None

        speci = self.jsons.create_specimen_json(lineage=lineage,  avaqty=av_qty, userid=user, initqty=init_qty, colltime=colltime,
                                        specimenclass=spec_class, specimentype=spec_type, anatomic=anat_site, storloc = storloc,
                                        label=speclabel, status=status, conttype = conttype, collproc=collproc, recqlt=rec_qlt,
                                        concentration=concentration, pathology=path, laterality=laterality, rectime=rectime)

        vis = json.loads(vis)
        speci= json.loads(speci)

        params={}
        params={&#34;visit&#34;:vis,
            &#34;specimens&#34;:[speci]}

        params=json.dumps(params)
        
        r = self.visit.add_visit_specimen(params)

        return r
    

    def update_visit(self, visitid, name = None, site = None, eventid=None, eventlabel=None, cprid= None, ppid=None, cptitle=None, 
                    cpshorttitle=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None,
                    missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, cpid=None):
        
        &#34;&#34;&#34;Updating a visit

        Update an existing visit with ID visitid and the parameters params. All parameters are
        optional for updating and  those which are not passed stay the same. Those parameters and 
        the visit Id have to be known to use this function and can
        be found out in the GUI by clicking on a participant and the visit. It looks like:
        http(s)://&lt;host&gt;:&lt;port&gt;/openspeicmen/cp-view/{cpid}/participant/{cprid}/visits/detail/ocerview?visitId={visitid}&amp;eventId={eventId} .
        Or via the function get_visit_namespr, when one knows the name of the visit and then extracts the id from there.

        Note
        ----
        All parameters are optional, except the visitid. The parameters which are not passed will stay the same.

        Parameters
        ----------
        visitid : int 
            Id of the visit, gets converted to a string
        
        name : string
            Name of the visit.
        
        site : string
            Site to which the visit belongs to.
        
        eventid : int
            ID of the event to which the visit belongs to.[optional]
        
        eventlabel : string
            Label of the event to which the visit belongs to.[optional]
        
        cprid : int
            Identifier of the Collection Protocoll Registration to which the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        ppid : string
            Identifier of the Participant to whom the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cptitle : string
            Name of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpshorttitle : title
            Acronym of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpid : int
            Identifier of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        diagnosis : string
            Name of the diagnoses of the visit.
        
        clinicalstatus : string
            Clinical Status of the visit.[optional]
        
        activity : string
            Activity Status of the visit.[optional]

        visitstatus : string
            Status of the visit.[optional]

        missedreason : string
            Reason why the visit was missed.[optional]

        missedby : string
            Details of the person who missed the visit.[optional]

        comments : string
            Comments regarding the visit.[optional]
        
        pathologynumber : string
            Surgical Pathology number. [optional]
        
        cohort : string
            Cohorts to which the visit belongs to. [optional]

        visitdate : string
            Date when the visit will occur, if empty takes the current date.[optional]

        Returns
        -------
        dict
            JSON-dict with details of the updated visit or OpenSpecimens Error message
        &#34;&#34;&#34;
        
        vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                        cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                        visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                        pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
        r = self.visit.update_visit(visitid = visitid, params = vis)

        return r

    def search_visit_namespr(self, visitname=None, sprnumber=None):

        &#34;&#34;&#34;Get a Visit by the name or the Surgical pathology number

        Get one or more visits by the name or the surgical pathology number. Those parameters have to be known 
        in order to know this function. If just the visitname is passed, one returns a visit with the corresponding name.
        If just the surgical pathology number is passed it returns all visits with this number. If both are passed
        it works as logical AND.

        Parameters
        ----------
        visitname : string
            Substring of the name of the visit.

        sprnumber : string
            Surgical Pathology number of the visits.

        Returns
        -------
        dict
            JSON-dict with details of the visits.
        &#34;&#34;&#34;

        searchstring = self.url.search_visit_name_spr(visitname = visitname, sprnumber = sprnumber)

        r = self.visit.get_visit_namespr(search_string =searchstring)

        return r
    
    def search_visit_cprid(self, cprid, includestats = &#34;false&#34;):
        
        &#34;&#34;&#34;Get a Visit by the Collection protocol Registration Id.

        Get a visit by the Collection Protocoll Registration ID. Those parameters have to be known 
        in order to know this function. They can be extracted from calling a search function in the 
        os_core class visits.

        Parameters
        ----------
        cprid : int
            Identifier of the collection protocol registration.
        
        includestats : string
            OpenSpecimen&#39;s boolean true/false. If true the stats of the participants, e.g. number of visits are included.
        
        Returns
        -------
        dict
            JSON-dict with details of the visit.
        &#34;&#34;&#34;

        searchstring = self.url.search_visit_cprid(cprid = cprid, includestats = includestats)
        r = self.visit.get_visits_cpr(search_string = searchstring)

        return r
        </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="OpenSpecimenAPIconnector.os_util.visit_util.visit_util"><code class="flex name class">
<span>class <span class="ident">visit_util</span></span>
</code></dt>
<dd>
<div class="desc"><p>Handles the API calls for Visits</p>
<p>This class handles the API calls for OpenSpecimen Visits. It can create, update,
search visits with different parameters, add visits and specimens in one call.
The outputs are JSON dicts or the Error messages as dict. </p>
<h2 id="notes">Notes</h2>
<p>In order to use this and also the other classes, the user has to know OpenSpecimen.
The API calls are documented in <a href="https://openspecimen.atlassian.net/wiki/spaces/CAT/pages/1116035/REST+APIs">https://openspecimen.atlassian.net/wiki/spaces/CAT/pages/1116035/REST+APIs</a> and
the calls refer to this site. More details can be seen in the documentation.</p>
<h2 id="example">Example</h2>
<p>A code example, where the visits are handled is in the Jupyter-Notebook::
$ jupyter notebook main.ipynb</p>
<p>Constructor of the Class visit</p>
<p>Constructor of the class visit, can handle the basic API-calls
of the visits in OpenSpecimen. It also connects this class to the os_core classes
visit, Json_factory, url_gen.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>base_url</code></strong> :&ensp;<code>string</code></dt>
<dd>URL to openspecimen, has the format: http(s)://<host>:<port>/openspecimen/rest/ng</dd>
<dt><strong><code>auth</code></strong> :&ensp;<code>tuple</code></dt>
<dd>Consists of two strings ( loginname , password)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class visit_util:

    &#34;&#34;&#34;Handles the API calls for Visits

    This class handles the API calls for OpenSpecimen Visits. It can create, update, 
    search visits with different parameters, add visits and specimens in one call.
    The outputs are JSON dicts or the Error messages as dict. 

    Notes
    -----
    In order to use this and also the other classes, the user has to know OpenSpecimen.
    The API calls are documented in https://openspecimen.atlassian.net/wiki/spaces/CAT/pages/1116035/REST+APIs and 
    the calls refer to this site. More details can be seen in the documentation.

    Example
    -------
    A code example, where the visits are handled is in the Jupyter-Notebook::
        $ jupyter notebook main.ipynb
    &#34;&#34;&#34;

    def __init__(self):

        &#34;&#34;&#34;Constructor of the Class visit
        
        Constructor of the class visit, can handle the basic API-calls
        of the visits in OpenSpecimen. It also connects this class to the os_core classes
        visit, Json_factory, url_gen.
        
        Parameters
        ----------
        base_url : string
            URL to openspecimen, has the format: http(s)://&lt;host&gt;:&lt;port&gt;/openspecimen/rest/ng
        auth : tuple
            Consists of two strings ( loginname , password)
        &#34;&#34;&#34; 

        self.visit = visit()
        self.jsons = Json_factory()
        self.url = url_gen()


    def add_visit(self, name, site, eventid=None, eventlabel=None, cprid= None, ppid=None, cptitle=None, cpshorttitle=None,
                        cpid=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=&#34;Complete&#34;, missedreason=None,
                        missedby=None, comments=None,pathologynumber=None,cohort=None, visitdate=None):
        
        &#34;&#34;&#34;Add a visit to a Participant.

        Add a visit to a participant in OpenSpecimen via API call. To use this function, one has to know the
        Parameters of the Participant, event and site.

        Note
        ----
        Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
        - name, site     

        Parameters
        ----------
        name : string
            Name of the Visit.

        site : string
            Site to which the Visit belongs to.

        eventid : int
            ID of the event to which the visit belongs to.[optional]

        eventlabel : string
            Label of the event to which the visit belongs to.[optional]

        cprid : int
            Identifier of the Collection Protocoll Registration to which the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        ppid : string
            Identifier of the Participant to whom the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        cptitle : string
            Name of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        cpshorttitle : title
            Acronym of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        cpid : int
            Identifier of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        diagnosis : string
            Name of the diagnoses of the visit.

        clinicalstatus : string
            Clinical Status of the visit.[optional]

        activity : string
            Activity Status of the Visit.[optional]

        visitstatus : string
            Status of the visit.[optional]

        missedreason : string
            Reason why the visit was missed.[optional]

        missedby : string
            Details of the person who missed the visit.[optional]

        comments : string
            Comments regarding the visit.[optional]

        pathologynumber : string
            Surgical Pathology number. [optional]

        cohort : string
            Cohorts to which the visit belongs to. [optional]

        visitdate : string
            Date when the visit will occur, if empty takes the current date.[optional]

        Returns
        -------
        dict
            Details of the visit as JSON dict or the Openspecimen&#39;s error message.
        &#34;&#34;&#34;

        vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                        cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                        visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                        pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
        
        r = self.visit.add_visit(params = vis)

        return r


    def add_visit_speci(self,  name, lineage, av_qty, user, init_qty, spec_class, spec_type, anat_site, site, path,
                        speclabel = None, eventid=None, eventlabel=None, cprid = None, ppid=None, cptitle=None, cpshorttitle=None,
                        cpid = None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None,
                        missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, laterality=None, rec_qlt = None,                        
                        colltime = None, rectime = None, status=&#34;Collected&#34;, stor_name=None, storlocx =None, storlocy =None, concentration=None, 
                        biohazrad = None, collproc=None, conttype = None, extensionudn = None, extensionmap = None,
                        extensiondict = None):

        &#34;&#34;&#34;Add a visit and a specimen in one call.
        
        Add a visit and a specimen in OpenSpecimen via one API call. To use this function, one has to know the
        Parameters of the participant, event and site.

        Note
        ----
        Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
        - name, site
        The label is mandatory if the Protocolsettings are such that the Label is created manually, otherwise
        it has to be left empty.  

        Parameters
        ----------
        cprid : int
            Identifier of the Collection Protocoll Registration to which the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        name : string
            Name of the Visit.
        
        lineage : string
            Lineage of the specimen, if created it is New.
        
        av_qty : int
            The available quantity of a specimen.
        
        user : int
            ID of the user who creates the specimen. If not specified the API user is taken.
        
        init_qty : int
            The initial quantity of a specimen.

        spec_class : string
            Class of the specimen.
        
        spec_type : string
            Type of the specimen, belongs to the class.
        
        anat_site : string
            The anatomic site of the specimen.

        site : string
            Site to which the visit belongs to.
        site,
        eventid : int
            ID of the event to which the visit belongs to.[optional]
        
        eventlabel : string
            Label of the event to which the visit belongs to.[optional]
        
        ppid : string
            Identifier of the Participant to whom the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cptitle : string
            Name of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpshorttitle : title
            Acronym of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpid : int
            Identifier of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        diagnosis : string
            Name of the diagnoses of the visit.
        
        clinicalstatus : string
            Clinical Status of the visit.[optional]
        
        activity : stringsite,
            Activity Status of the visit.[optional]

        visitstatus : string
            Status of the visit.[optional]

        missedreason : string
            Reason why the visit was missed.[optional]

        missedby : string
            Details of the person who missed the visit.[optional]

        comments : string
            Comments regarding the visit.[optional]
        
        pathologynumber : string
            Surgical Pathology number. [optional]
        
        cohort : string
            Cohorts to which the visit belongs to. [optional]

        visitdate : string
            Date when the visit will occur, if empty takes the current date.[optional]
        
        pathology : string
            Pathologystatus of the Specimen.
        
        laterality : string
            The laterality of the specimen.
               
        recqlt : string
            The received quality.
   
        colltime : string
            Date and Time of the collection event, the format is in the OpenSpecimen&#39;s System configuration.[optional]
            
        rectime : string
            Date and Time of the received event, the format is in the OpenSpecimen&#39;s System configuration.[optional]
                        
        status : string
            Status of the Specimen, default is &#39;Collected&#39;.
        
        stor_name : string
            Name of the container. [optional]
        
        storlocx : int
            Position of the specimen in the Container in x direction.[optional]

        storlocy : int
            Position of the specimen in the container in y direction.[optional]
            
        concetration  : int
            Concentration of the specimen[optional].
        
        biohazard : string
            Biohazards of that specimen.[optional]
                    
        comments : string
            Comments regarding to the specimen[optional].
        
        collproc : string
            The procedure of the collection[otpional].

        conttype : string
            Type of the storage container.
            
        extensionudn : string
            OpenSpecimen&#39;s boolean true/false. If true, the extension keys are the udn values of the corresponding form.[optional]
        
        extensionmap : string
            The name of the form which should be taken.[optional]

        extensiondict : dict
            The dictionary of the extensions, has to be created manually. Either with udn or name (as defined before). [optional]

        Returns
        -------
        dict
            Details of the visit and specimen as JSON dict or the Openspecimen&#39;s error message.
        &#34;&#34;&#34;

        vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                        cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                        visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                        pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
        
        if stor_name!=None:
            storloc = self.jsons.storage_location_json(name= stor_name, xpos=storlocx, ypos= storlocy)
        else:
            storloc=None

        speci = self.jsons.create_specimen_json(lineage=lineage,  avaqty=av_qty, userid=user, initqty=init_qty, colltime=colltime,
                                        specimenclass=spec_class, specimentype=spec_type, anatomic=anat_site, storloc = storloc,
                                        label=speclabel, status=status, conttype = conttype, collproc=collproc, recqlt=rec_qlt,
                                        concentration=concentration, pathology=path, laterality=laterality, rectime=rectime)

        vis = json.loads(vis)
        speci= json.loads(speci)

        params={}
        params={&#34;visit&#34;:vis,
            &#34;specimens&#34;:[speci]}

        params=json.dumps(params)
        
        r = self.visit.add_visit_specimen(params)

        return r
    

    def update_visit(self, visitid, name = None, site = None, eventid=None, eventlabel=None, cprid= None, ppid=None, cptitle=None, 
                    cpshorttitle=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None,
                    missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, cpid=None):
        
        &#34;&#34;&#34;Updating a visit

        Update an existing visit with ID visitid and the parameters params. All parameters are
        optional for updating and  those which are not passed stay the same. Those parameters and 
        the visit Id have to be known to use this function and can
        be found out in the GUI by clicking on a participant and the visit. It looks like:
        http(s)://&lt;host&gt;:&lt;port&gt;/openspeicmen/cp-view/{cpid}/participant/{cprid}/visits/detail/ocerview?visitId={visitid}&amp;eventId={eventId} .
        Or via the function get_visit_namespr, when one knows the name of the visit and then extracts the id from there.

        Note
        ----
        All parameters are optional, except the visitid. The parameters which are not passed will stay the same.

        Parameters
        ----------
        visitid : int 
            Id of the visit, gets converted to a string
        
        name : string
            Name of the visit.
        
        site : string
            Site to which the visit belongs to.
        
        eventid : int
            ID of the event to which the visit belongs to.[optional]
        
        eventlabel : string
            Label of the event to which the visit belongs to.[optional]
        
        cprid : int
            Identifier of the Collection Protocoll Registration to which the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        ppid : string
            Identifier of the Participant to whom the visit belongs to.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cptitle : string
            Name of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpshorttitle : title
            Acronym of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
        
        cpid : int
            Identifier of the Collection Protocol.
            cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

        diagnosis : string
            Name of the diagnoses of the visit.
        
        clinicalstatus : string
            Clinical Status of the visit.[optional]
        
        activity : string
            Activity Status of the visit.[optional]

        visitstatus : string
            Status of the visit.[optional]

        missedreason : string
            Reason why the visit was missed.[optional]

        missedby : string
            Details of the person who missed the visit.[optional]

        comments : string
            Comments regarding the visit.[optional]
        
        pathologynumber : string
            Surgical Pathology number. [optional]
        
        cohort : string
            Cohorts to which the visit belongs to. [optional]

        visitdate : string
            Date when the visit will occur, if empty takes the current date.[optional]

        Returns
        -------
        dict
            JSON-dict with details of the updated visit or OpenSpecimens Error message
        &#34;&#34;&#34;
        
        vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                        cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                        visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                        pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
        r = self.visit.update_visit(visitid = visitid, params = vis)

        return r

    def search_visit_namespr(self, visitname=None, sprnumber=None):

        &#34;&#34;&#34;Get a Visit by the name or the Surgical pathology number

        Get one or more visits by the name or the surgical pathology number. Those parameters have to be known 
        in order to know this function. If just the visitname is passed, one returns a visit with the corresponding name.
        If just the surgical pathology number is passed it returns all visits with this number. If both are passed
        it works as logical AND.

        Parameters
        ----------
        visitname : string
            Substring of the name of the visit.

        sprnumber : string
            Surgical Pathology number of the visits.

        Returns
        -------
        dict
            JSON-dict with details of the visits.
        &#34;&#34;&#34;

        searchstring = self.url.search_visit_name_spr(visitname = visitname, sprnumber = sprnumber)

        r = self.visit.get_visit_namespr(search_string =searchstring)

        return r
    
    def search_visit_cprid(self, cprid, includestats = &#34;false&#34;):
        
        &#34;&#34;&#34;Get a Visit by the Collection protocol Registration Id.

        Get a visit by the Collection Protocoll Registration ID. Those parameters have to be known 
        in order to know this function. They can be extracted from calling a search function in the 
        os_core class visits.

        Parameters
        ----------
        cprid : int
            Identifier of the collection protocol registration.
        
        includestats : string
            OpenSpecimen&#39;s boolean true/false. If true the stats of the participants, e.g. number of visits are included.
        
        Returns
        -------
        dict
            JSON-dict with details of the visit.
        &#34;&#34;&#34;

        searchstring = self.url.search_visit_cprid(cprid = cprid, includestats = includestats)
        r = self.visit.get_visits_cpr(search_string = searchstring)

        return r</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.add_visit"><code class="name flex">
<span>def <span class="ident">add_visit</span></span>(<span>self, name, site, eventid=None, eventlabel=None, cprid=None, ppid=None, cptitle=None, cpshorttitle=None, cpid=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus='Complete', missedreason=None, missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Add a visit to a Participant.</p>
<p>Add a visit to a participant in OpenSpecimen via API call. To use this function, one has to know the
Parameters of the Participant, event and site.</p>
<h2 id="note">Note</h2>
<p>Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
- name, site
</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the Visit.</dd>
<dt><strong><code>site</code></strong> :&ensp;<code>string</code></dt>
<dd>Site to which the Visit belongs to.</dd>
<dt><strong><code>eventid</code></strong> :&ensp;<code>int</code></dt>
<dd>ID of the event to which the visit belongs to.[optional]</dd>
<dt><strong><code>eventlabel</code></strong> :&ensp;<code>string</code></dt>
<dd>Label of the event to which the visit belongs to.[optional]</dd>
<dt><strong><code>cprid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the Collection Protocoll Registration to which the visit belongs to.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>ppid</code></strong> :&ensp;<code>string</code></dt>
<dd>Identifier of the Participant to whom the visit belongs to.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cptitle</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cpshorttitle</code></strong> :&ensp;<code>title</code></dt>
<dd>Acronym of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cpid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>diagnosis</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the diagnoses of the visit.</dd>
<dt><strong><code>clinicalstatus</code></strong> :&ensp;<code>string</code></dt>
<dd>Clinical Status of the visit.[optional]</dd>
<dt><strong><code>activity</code></strong> :&ensp;<code>string</code></dt>
<dd>Activity Status of the Visit.[optional]</dd>
<dt><strong><code>visitstatus</code></strong> :&ensp;<code>string</code></dt>
<dd>Status of the visit.[optional]</dd>
<dt><strong><code>missedreason</code></strong> :&ensp;<code>string</code></dt>
<dd>Reason why the visit was missed.[optional]</dd>
<dt><strong><code>missedby</code></strong> :&ensp;<code>string</code></dt>
<dd>Details of the person who missed the visit.[optional]</dd>
<dt><strong><code>comments</code></strong> :&ensp;<code>string</code></dt>
<dd>Comments regarding the visit.[optional]</dd>
<dt><strong><code>pathologynumber</code></strong> :&ensp;<code>string</code></dt>
<dd>Surgical Pathology number. [optional]</dd>
<dt><strong><code>cohort</code></strong> :&ensp;<code>string</code></dt>
<dd>Cohorts to which the visit belongs to. [optional]</dd>
<dt><strong><code>visitdate</code></strong> :&ensp;<code>string</code></dt>
<dd>Date when the visit will occur, if empty takes the current date.[optional]</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>Details of the visit as JSON dict or the Openspecimen's error message.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_visit(self, name, site, eventid=None, eventlabel=None, cprid= None, ppid=None, cptitle=None, cpshorttitle=None,
                    cpid=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=&#34;Complete&#34;, missedreason=None,
                    missedby=None, comments=None,pathologynumber=None,cohort=None, visitdate=None):
    
    &#34;&#34;&#34;Add a visit to a Participant.

    Add a visit to a participant in OpenSpecimen via API call. To use this function, one has to know the
    Parameters of the Participant, event and site.

    Note
    ----
    Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
    - name, site     

    Parameters
    ----------
    name : string
        Name of the Visit.

    site : string
        Site to which the Visit belongs to.

    eventid : int
        ID of the event to which the visit belongs to.[optional]

    eventlabel : string
        Label of the event to which the visit belongs to.[optional]

    cprid : int
        Identifier of the Collection Protocoll Registration to which the visit belongs to.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    ppid : string
        Identifier of the Participant to whom the visit belongs to.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    cptitle : string
        Name of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    cpshorttitle : title
        Acronym of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    cpid : int
        Identifier of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    diagnosis : string
        Name of the diagnoses of the visit.

    clinicalstatus : string
        Clinical Status of the visit.[optional]

    activity : string
        Activity Status of the Visit.[optional]

    visitstatus : string
        Status of the visit.[optional]

    missedreason : string
        Reason why the visit was missed.[optional]

    missedby : string
        Details of the person who missed the visit.[optional]

    comments : string
        Comments regarding the visit.[optional]

    pathologynumber : string
        Surgical Pathology number. [optional]

    cohort : string
        Cohorts to which the visit belongs to. [optional]

    visitdate : string
        Date when the visit will occur, if empty takes the current date.[optional]

    Returns
    -------
    dict
        Details of the visit as JSON dict or the Openspecimen&#39;s error message.
    &#34;&#34;&#34;

    vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                    cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                    visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                    pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
    
    r = self.visit.add_visit(params = vis)

    return r</code></pre>
</details>
</dd>
<dt id="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.add_visit_speci"><code class="name flex">
<span>def <span class="ident">add_visit_speci</span></span>(<span>self, name, lineage, av_qty, user, init_qty, spec_class, spec_type, anat_site, site, path, speclabel=None, eventid=None, eventlabel=None, cprid=None, ppid=None, cptitle=None, cpshorttitle=None, cpid=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None, missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, laterality=None, rec_qlt=None, colltime=None, rectime=None, status='Collected', stor_name=None, storlocx=None, storlocy=None, concentration=None, biohazrad=None, collproc=None, conttype=None, extensionudn=None, extensionmap=None, extensiondict=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Add a visit and a specimen in one call.</p>
<p>Add a visit and a specimen in OpenSpecimen via one API call. To use this function, one has to know the
Parameters of the participant, event and site.</p>
<h2 id="note">Note</h2>
<p>Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
- name, site
The label is mandatory if the Protocolsettings are such that the Label is created manually, otherwise
it has to be left empty.
</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>cprid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the Collection Protocoll Registration to which the visit belongs to.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the Visit.</dd>
<dt><strong><code>lineage</code></strong> :&ensp;<code>string</code></dt>
<dd>Lineage of the specimen, if created it is New.</dd>
<dt><strong><code>av_qty</code></strong> :&ensp;<code>int</code></dt>
<dd>The available quantity of a specimen.</dd>
<dt><strong><code>user</code></strong> :&ensp;<code>int</code></dt>
<dd>ID of the user who creates the specimen. If not specified the API user is taken.</dd>
<dt><strong><code>init_qty</code></strong> :&ensp;<code>int</code></dt>
<dd>The initial quantity of a specimen.</dd>
<dt><strong><code>spec_class</code></strong> :&ensp;<code>string</code></dt>
<dd>Class of the specimen.</dd>
<dt><strong><code>spec_type</code></strong> :&ensp;<code>string</code></dt>
<dd>Type of the specimen, belongs to the class.</dd>
<dt><strong><code>anat_site</code></strong> :&ensp;<code>string</code></dt>
<dd>The anatomic site of the specimen.</dd>
<dt><strong><code>site</code></strong> :&ensp;<code>string</code></dt>
<dd>Site to which the visit belongs to.</dd>
<dt>site,</dt>
<dt><strong><code>eventid</code></strong> :&ensp;<code>int</code></dt>
<dd>ID of the event to which the visit belongs to.[optional]</dd>
<dt><strong><code>eventlabel</code></strong> :&ensp;<code>string</code></dt>
<dd>Label of the event to which the visit belongs to.[optional]</dd>
<dt><strong><code>ppid</code></strong> :&ensp;<code>string</code></dt>
<dd>Identifier of the Participant to whom the visit belongs to.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cptitle</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cpshorttitle</code></strong> :&ensp;<code>title</code></dt>
<dd>Acronym of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cpid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>diagnosis</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the diagnoses of the visit.</dd>
<dt><strong><code>clinicalstatus</code></strong> :&ensp;<code>string</code></dt>
<dd>Clinical Status of the visit.[optional]</dd>
<dt><strong><code>activity</code></strong> :&ensp;<code>stringsite,</code></dt>
<dd>Activity Status of the visit.[optional]</dd>
<dt><strong><code>visitstatus</code></strong> :&ensp;<code>string</code></dt>
<dd>Status of the visit.[optional]</dd>
<dt><strong><code>missedreason</code></strong> :&ensp;<code>string</code></dt>
<dd>Reason why the visit was missed.[optional]</dd>
<dt><strong><code>missedby</code></strong> :&ensp;<code>string</code></dt>
<dd>Details of the person who missed the visit.[optional]</dd>
<dt><strong><code>comments</code></strong> :&ensp;<code>string</code></dt>
<dd>Comments regarding the visit.[optional]</dd>
<dt><strong><code>pathologynumber</code></strong> :&ensp;<code>string</code></dt>
<dd>Surgical Pathology number. [optional]</dd>
<dt><strong><code>cohort</code></strong> :&ensp;<code>string</code></dt>
<dd>Cohorts to which the visit belongs to. [optional]</dd>
<dt><strong><code>visitdate</code></strong> :&ensp;<code>string</code></dt>
<dd>Date when the visit will occur, if empty takes the current date.[optional]</dd>
<dt><strong><code>pathology</code></strong> :&ensp;<code>string</code></dt>
<dd>Pathologystatus of the Specimen.</dd>
<dt><strong><code>laterality</code></strong> :&ensp;<code>string</code></dt>
<dd>The laterality of the specimen.</dd>
<dt><strong><code>recqlt</code></strong> :&ensp;<code>string</code></dt>
<dd>The received quality.</dd>
<dt><strong><code>colltime</code></strong> :&ensp;<code>string</code></dt>
<dd>Date and Time of the collection event, the format is in the OpenSpecimen's System configuration.[optional]</dd>
<dt><strong><code>rectime</code></strong> :&ensp;<code>string</code></dt>
<dd>Date and Time of the received event, the format is in the OpenSpecimen's System configuration.[optional]</dd>
<dt><strong><code>status</code></strong> :&ensp;<code>string</code></dt>
<dd>Status of the Specimen, default is 'Collected'.</dd>
<dt><strong><code>stor_name</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the container. [optional]</dd>
<dt><strong><code>storlocx</code></strong> :&ensp;<code>int</code></dt>
<dd>Position of the specimen in the Container in x direction.[optional]</dd>
<dt><strong><code>storlocy</code></strong> :&ensp;<code>int</code></dt>
<dd>Position of the specimen in the container in y direction.[optional]</dd>
</dl>
<p>concetration
: int
Concentration of the specimen[optional].</p>
<dl>
<dt><strong><code>biohazard</code></strong> :&ensp;<code>string</code></dt>
<dd>Biohazards of that specimen.[optional]</dd>
<dt><strong><code>comments</code></strong> :&ensp;<code>string</code></dt>
<dd>Comments regarding to the specimen[optional].</dd>
<dt><strong><code>collproc</code></strong> :&ensp;<code>string</code></dt>
<dd>The procedure of the collection[otpional].</dd>
<dt><strong><code>conttype</code></strong> :&ensp;<code>string</code></dt>
<dd>Type of the storage container.</dd>
<dt><strong><code>extensionudn</code></strong> :&ensp;<code>string</code></dt>
<dd>OpenSpecimen's boolean true/false. If true, the extension keys are the udn values of the corresponding form.[optional]</dd>
<dt><strong><code>extensionmap</code></strong> :&ensp;<code>string</code></dt>
<dd>The name of the form which should be taken.[optional]</dd>
<dt><strong><code>extensiondict</code></strong> :&ensp;<code>dict</code></dt>
<dd>The dictionary of the extensions, has to be created manually. Either with udn or name (as defined before). [optional]</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>Details of the visit and specimen as JSON dict or the Openspecimen's error message.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_visit_speci(self,  name, lineage, av_qty, user, init_qty, spec_class, spec_type, anat_site, site, path,
                    speclabel = None, eventid=None, eventlabel=None, cprid = None, ppid=None, cptitle=None, cpshorttitle=None,
                    cpid = None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None,
                    missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, laterality=None, rec_qlt = None,                        
                    colltime = None, rectime = None, status=&#34;Collected&#34;, stor_name=None, storlocx =None, storlocy =None, concentration=None, 
                    biohazrad = None, collproc=None, conttype = None, extensionudn = None, extensionmap = None,
                    extensiondict = None):

    &#34;&#34;&#34;Add a visit and a specimen in one call.
    
    Add a visit and a specimen in OpenSpecimen via one API call. To use this function, one has to know the
    Parameters of the participant, event and site.

    Note
    ----
    Mandatory fields are -cprId or (ppid and cpTitle) or (ppid and cpShortTitle) or (ppid and cpid)
    - name, site
    The label is mandatory if the Protocolsettings are such that the Label is created manually, otherwise
    it has to be left empty.  

    Parameters
    ----------
    cprid : int
        Identifier of the Collection Protocoll Registration to which the visit belongs to.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    name : string
        Name of the Visit.
    
    lineage : string
        Lineage of the specimen, if created it is New.
    
    av_qty : int
        The available quantity of a specimen.
    
    user : int
        ID of the user who creates the specimen. If not specified the API user is taken.
    
    init_qty : int
        The initial quantity of a specimen.

    spec_class : string
        Class of the specimen.
    
    spec_type : string
        Type of the specimen, belongs to the class.
    
    anat_site : string
        The anatomic site of the specimen.

    site : string
        Site to which the visit belongs to.
    site,
    eventid : int
        ID of the event to which the visit belongs to.[optional]
    
    eventlabel : string
        Label of the event to which the visit belongs to.[optional]
    
    ppid : string
        Identifier of the Participant to whom the visit belongs to.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
    
    cptitle : string
        Name of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
    
    cpshorttitle : title
        Acronym of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
    
    cpid : int
        Identifier of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    diagnosis : string
        Name of the diagnoses of the visit.
    
    clinicalstatus : string
        Clinical Status of the visit.[optional]
    
    activity : stringsite,
        Activity Status of the visit.[optional]

    visitstatus : string
        Status of the visit.[optional]

    missedreason : string
        Reason why the visit was missed.[optional]

    missedby : string
        Details of the person who missed the visit.[optional]

    comments : string
        Comments regarding the visit.[optional]
    
    pathologynumber : string
        Surgical Pathology number. [optional]
    
    cohort : string
        Cohorts to which the visit belongs to. [optional]

    visitdate : string
        Date when the visit will occur, if empty takes the current date.[optional]
    
    pathology : string
        Pathologystatus of the Specimen.
    
    laterality : string
        The laterality of the specimen.
           
    recqlt : string
        The received quality.

    colltime : string
        Date and Time of the collection event, the format is in the OpenSpecimen&#39;s System configuration.[optional]
        
    rectime : string
        Date and Time of the received event, the format is in the OpenSpecimen&#39;s System configuration.[optional]
                    
    status : string
        Status of the Specimen, default is &#39;Collected&#39;.
    
    stor_name : string
        Name of the container. [optional]
    
    storlocx : int
        Position of the specimen in the Container in x direction.[optional]

    storlocy : int
        Position of the specimen in the container in y direction.[optional]
        
    concetration  : int
        Concentration of the specimen[optional].
    
    biohazard : string
        Biohazards of that specimen.[optional]
                
    comments : string
        Comments regarding to the specimen[optional].
    
    collproc : string
        The procedure of the collection[otpional].

    conttype : string
        Type of the storage container.
        
    extensionudn : string
        OpenSpecimen&#39;s boolean true/false. If true, the extension keys are the udn values of the corresponding form.[optional]
    
    extensionmap : string
        The name of the form which should be taken.[optional]

    extensiondict : dict
        The dictionary of the extensions, has to be created manually. Either with udn or name (as defined before). [optional]

    Returns
    -------
    dict
        Details of the visit and specimen as JSON dict or the Openspecimen&#39;s error message.
    &#34;&#34;&#34;

    vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                    cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                    visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                    pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
    
    if stor_name!=None:
        storloc = self.jsons.storage_location_json(name= stor_name, xpos=storlocx, ypos= storlocy)
    else:
        storloc=None

    speci = self.jsons.create_specimen_json(lineage=lineage,  avaqty=av_qty, userid=user, initqty=init_qty, colltime=colltime,
                                    specimenclass=spec_class, specimentype=spec_type, anatomic=anat_site, storloc = storloc,
                                    label=speclabel, status=status, conttype = conttype, collproc=collproc, recqlt=rec_qlt,
                                    concentration=concentration, pathology=path, laterality=laterality, rectime=rectime)

    vis = json.loads(vis)
    speci= json.loads(speci)

    params={}
    params={&#34;visit&#34;:vis,
        &#34;specimens&#34;:[speci]}

    params=json.dumps(params)
    
    r = self.visit.add_visit_specimen(params)

    return r</code></pre>
</details>
</dd>
<dt id="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.search_visit_cprid"><code class="name flex">
<span>def <span class="ident">search_visit_cprid</span></span>(<span>self, cprid, includestats='false')</span>
</code></dt>
<dd>
<div class="desc"><p>Get a Visit by the Collection protocol Registration Id.</p>
<p>Get a visit by the Collection Protocoll Registration ID. Those parameters have to be known
in order to know this function. They can be extracted from calling a search function in the
os_core class visits.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>cprid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the collection protocol registration.</dd>
<dt><strong><code>includestats</code></strong> :&ensp;<code>string</code></dt>
<dd>OpenSpecimen's boolean true/false. If true the stats of the participants, e.g. number of visits are included.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>JSON-dict with details of the visit.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def search_visit_cprid(self, cprid, includestats = &#34;false&#34;):
    
    &#34;&#34;&#34;Get a Visit by the Collection protocol Registration Id.

    Get a visit by the Collection Protocoll Registration ID. Those parameters have to be known 
    in order to know this function. They can be extracted from calling a search function in the 
    os_core class visits.

    Parameters
    ----------
    cprid : int
        Identifier of the collection protocol registration.
    
    includestats : string
        OpenSpecimen&#39;s boolean true/false. If true the stats of the participants, e.g. number of visits are included.
    
    Returns
    -------
    dict
        JSON-dict with details of the visit.
    &#34;&#34;&#34;

    searchstring = self.url.search_visit_cprid(cprid = cprid, includestats = includestats)
    r = self.visit.get_visits_cpr(search_string = searchstring)

    return r</code></pre>
</details>
</dd>
<dt id="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.search_visit_namespr"><code class="name flex">
<span>def <span class="ident">search_visit_namespr</span></span>(<span>self, visitname=None, sprnumber=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Get a Visit by the name or the Surgical pathology number</p>
<p>Get one or more visits by the name or the surgical pathology number. Those parameters have to be known
in order to know this function. If just the visitname is passed, one returns a visit with the corresponding name.
If just the surgical pathology number is passed it returns all visits with this number. If both are passed
it works as logical AND.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>visitname</code></strong> :&ensp;<code>string</code></dt>
<dd>Substring of the name of the visit.</dd>
<dt><strong><code>sprnumber</code></strong> :&ensp;<code>string</code></dt>
<dd>Surgical Pathology number of the visits.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>JSON-dict with details of the visits.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def search_visit_namespr(self, visitname=None, sprnumber=None):

    &#34;&#34;&#34;Get a Visit by the name or the Surgical pathology number

    Get one or more visits by the name or the surgical pathology number. Those parameters have to be known 
    in order to know this function. If just the visitname is passed, one returns a visit with the corresponding name.
    If just the surgical pathology number is passed it returns all visits with this number. If both are passed
    it works as logical AND.

    Parameters
    ----------
    visitname : string
        Substring of the name of the visit.

    sprnumber : string
        Surgical Pathology number of the visits.

    Returns
    -------
    dict
        JSON-dict with details of the visits.
    &#34;&#34;&#34;

    searchstring = self.url.search_visit_name_spr(visitname = visitname, sprnumber = sprnumber)

    r = self.visit.get_visit_namespr(search_string =searchstring)

    return r</code></pre>
</details>
</dd>
<dt id="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.update_visit"><code class="name flex">
<span>def <span class="ident">update_visit</span></span>(<span>self, visitid, name=None, site=None, eventid=None, eventlabel=None, cprid=None, ppid=None, cptitle=None, cpshorttitle=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None, missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, cpid=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Updating a visit</p>
<p>Update an existing visit with ID visitid and the parameters params. All parameters are
optional for updating and
those which are not passed stay the same. Those parameters and
the visit Id have to be known to use this function and can
be found out in the GUI by clicking on a participant and the visit. It looks like:
http(s)://<host>:<port>/openspeicmen/cp-view/{cpid}/participant/{cprid}/visits/detail/ocerview?visitId={visitid}&amp;eventId={eventId} .
Or via the function get_visit_namespr, when one knows the name of the visit and then extracts the id from there.</p>
<h2 id="note">Note</h2>
<p>All parameters are optional, except the visitid. The parameters which are not passed will stay the same.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>visitid</code></strong> :&ensp;<code>int </code></dt>
<dd>Id of the visit, gets converted to a string</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the visit.</dd>
<dt><strong><code>site</code></strong> :&ensp;<code>string</code></dt>
<dd>Site to which the visit belongs to.</dd>
<dt><strong><code>eventid</code></strong> :&ensp;<code>int</code></dt>
<dd>ID of the event to which the visit belongs to.[optional]</dd>
<dt><strong><code>eventlabel</code></strong> :&ensp;<code>string</code></dt>
<dd>Label of the event to which the visit belongs to.[optional]</dd>
<dt><strong><code>cprid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the Collection Protocoll Registration to which the visit belongs to.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>ppid</code></strong> :&ensp;<code>string</code></dt>
<dd>Identifier of the Participant to whom the visit belongs to.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cptitle</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cpshorttitle</code></strong> :&ensp;<code>title</code></dt>
<dd>Acronym of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>cpid</code></strong> :&ensp;<code>int</code></dt>
<dd>Identifier of the Collection Protocol.
cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.</dd>
<dt><strong><code>diagnosis</code></strong> :&ensp;<code>string</code></dt>
<dd>Name of the diagnoses of the visit.</dd>
<dt><strong><code>clinicalstatus</code></strong> :&ensp;<code>string</code></dt>
<dd>Clinical Status of the visit.[optional]</dd>
<dt><strong><code>activity</code></strong> :&ensp;<code>string</code></dt>
<dd>Activity Status of the visit.[optional]</dd>
<dt><strong><code>visitstatus</code></strong> :&ensp;<code>string</code></dt>
<dd>Status of the visit.[optional]</dd>
<dt><strong><code>missedreason</code></strong> :&ensp;<code>string</code></dt>
<dd>Reason why the visit was missed.[optional]</dd>
<dt><strong><code>missedby</code></strong> :&ensp;<code>string</code></dt>
<dd>Details of the person who missed the visit.[optional]</dd>
<dt><strong><code>comments</code></strong> :&ensp;<code>string</code></dt>
<dd>Comments regarding the visit.[optional]</dd>
<dt><strong><code>pathologynumber</code></strong> :&ensp;<code>string</code></dt>
<dd>Surgical Pathology number. [optional]</dd>
<dt><strong><code>cohort</code></strong> :&ensp;<code>string</code></dt>
<dd>Cohorts to which the visit belongs to. [optional]</dd>
<dt><strong><code>visitdate</code></strong> :&ensp;<code>string</code></dt>
<dd>Date when the visit will occur, if empty takes the current date.[optional]</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>JSON-dict with details of the updated visit or OpenSpecimens Error message</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update_visit(self, visitid, name = None, site = None, eventid=None, eventlabel=None, cprid= None, ppid=None, cptitle=None, 
                cpshorttitle=None, diagnosis=None, clinicalstatus=None, activity=None, visitstatus=None, missedreason=None,
                missedby=None, comments=None, pathologynumber=None, cohort=None, visitdate=None, cpid=None):
    
    &#34;&#34;&#34;Updating a visit

    Update an existing visit with ID visitid and the parameters params. All parameters are
    optional for updating and  those which are not passed stay the same. Those parameters and 
    the visit Id have to be known to use this function and can
    be found out in the GUI by clicking on a participant and the visit. It looks like:
    http(s)://&lt;host&gt;:&lt;port&gt;/openspeicmen/cp-view/{cpid}/participant/{cprid}/visits/detail/ocerview?visitId={visitid}&amp;eventId={eventId} .
    Or via the function get_visit_namespr, when one knows the name of the visit and then extracts the id from there.

    Note
    ----
    All parameters are optional, except the visitid. The parameters which are not passed will stay the same.

    Parameters
    ----------
    visitid : int 
        Id of the visit, gets converted to a string
    
    name : string
        Name of the visit.
    
    site : string
        Site to which the visit belongs to.
    
    eventid : int
        ID of the event to which the visit belongs to.[optional]
    
    eventlabel : string
        Label of the event to which the visit belongs to.[optional]
    
    cprid : int
        Identifier of the Collection Protocoll Registration to which the visit belongs to.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    ppid : string
        Identifier of the Participant to whom the visit belongs to.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
    
    cptitle : string
        Name of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
    
    cpshorttitle : title
        Acronym of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.
    
    cpid : int
        Identifier of the Collection Protocol.
        cprid or (cptitle and ppid) or (cpid and ppid) or (cpshorttitle and ppid) are mandatory.

    diagnosis : string
        Name of the diagnoses of the visit.
    
    clinicalstatus : string
        Clinical Status of the visit.[optional]
    
    activity : string
        Activity Status of the visit.[optional]

    visitstatus : string
        Status of the visit.[optional]

    missedreason : string
        Reason why the visit was missed.[optional]

    missedby : string
        Details of the person who missed the visit.[optional]

    comments : string
        Comments regarding the visit.[optional]
    
    pathologynumber : string
        Surgical Pathology number. [optional]
    
    cohort : string
        Cohorts to which the visit belongs to. [optional]

    visitdate : string
        Date when the visit will occur, if empty takes the current date.[optional]

    Returns
    -------
    dict
        JSON-dict with details of the updated visit or OpenSpecimens Error message
    &#34;&#34;&#34;
    
    vis = self.jsons.add_visit_json(cprid=cprid, name=name, site=site, eventid=eventid, eventlabel=eventlabel, ppid=ppid, cptitle=cptitle, 
                                    cpshorttitle=cpshorttitle, diagnosis=diagnosis,clinicalstatus=clinicalstatus, activity=activity,
                                    visitstatus=visitstatus, missedreason=missedreason, missedby=missedby, comments=comments,
                                    pathologynumber=pathologynumber, cohort=cohort, visitdate=visitdate, cpid=cpid)
    r = self.visit.update_visit(visitid = visitid, params = vis)

    return r</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="OpenSpecimenAPIconnector.os_util" href="index.html">OpenSpecimenAPIconnector.os_util</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="OpenSpecimenAPIconnector.os_util.visit_util.visit_util" href="#OpenSpecimenAPIconnector.os_util.visit_util.visit_util">visit_util</a></code></h4>
<ul class="">
<li><code><a title="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.add_visit" href="#OpenSpecimenAPIconnector.os_util.visit_util.visit_util.add_visit">add_visit</a></code></li>
<li><code><a title="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.add_visit_speci" href="#OpenSpecimenAPIconnector.os_util.visit_util.visit_util.add_visit_speci">add_visit_speci</a></code></li>
<li><code><a title="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.search_visit_cprid" href="#OpenSpecimenAPIconnector.os_util.visit_util.visit_util.search_visit_cprid">search_visit_cprid</a></code></li>
<li><code><a title="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.search_visit_namespr" href="#OpenSpecimenAPIconnector.os_util.visit_util.visit_util.search_visit_namespr">search_visit_namespr</a></code></li>
<li><code><a title="OpenSpecimenAPIconnector.os_util.visit_util.visit_util.update_visit" href="#OpenSpecimenAPIconnector.os_util.visit_util.visit_util.update_visit">update_visit</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>